/*
 * SPDX-License-Identifier: ISC
 * SPDX-URL: https://spdx.org/licenses/ISC.html
 *
 * Copyright (C) 2018 Aaron M. D. Jones <aaronmdjones@gmail.com>
 *
 * Digest interface testsuite.
 */

#include "atheme.h"

/*
 * MD5 test vectors taken from RFC 1321 Appendix A.5:
 *   <https://tools.ietf.org/html/rfc1321.html#appendix-A.5>
 *
 * SHA1 test vectors taken from RFC 3174 Section 7.3:
 *   <https://tools.ietf.org/html/rfc3174#section-7.3>
 *
 * SHA2-256 test vectors taken from:
 *   <https://www.di-mgt.com.au/sha_testvectors.html>
 *
 * SHA2-512 test vectors taken from:
 *   <https://www.di-mgt.com.au/sha_testvectors.html>
 *
 * HMAC-MD5 test vectors taken from RFC 2202 Section 2:
 *   <https://tools.ietf.org/html/rfc2202.html#section-2>
 *
 * HMAC-SHA1 test vectors taken from RFC 2202 Section 3:
 *   <https://tools.ietf.org/html/rfc2202.html#section-3>
 *
 * HMAC-SHA2-256 test vectors taken from RFC 4231 Section 4.1:
 *   <https://tools.ietf.org/html/rfc4231#section-4.1>
 *
 * HMAC-SHA2-512 test vectors taken from RFC 4231 Section 4.1:
 *   <https://tools.ietf.org/html/rfc4231#section-4.1>
 *
 * PBKDF2 vectors for MD5, SHA1, SHA2-256 & SHA2-512 were generated
 * by the PKCS5_PBKDF2_HMAC() function in OpenSSL:
 *   <https://www.openssl.org/>
 *   <https://github.com/openssl/openssl/blob/8d049ed24b06ada5/crypto/evp/p5_crpt2.c#L25-L34>
 *
 * The PBKDF2 vectors cover the following 4 cases:
 * - PassLen = 0, SaltLen = 0, dkLen = hLen
 * - PassLen = 0, SaltLen > 0, dkLen = hLen
 * - PassLen > 0, SaltLen = 0, dkLen = hLen
 * - PassLen > 0, SaltLen > 0, dkLen > hLen
 */

static bool
digest_testsuite_run_md5(void)
{
	uint8_t result[DIGEST_MDLEN_MD5];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0xD4U, 0x1DU, 0x8CU, 0xD9U, 0x8FU, 0x00U, 0xB2U, 0x04U,
			0xE9U, 0x80U, 0x09U, 0x98U, 0xECU, 0xF8U, 0x42U, 0x7EU,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, NULL, 0, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char data[1] = "a";

		static const uint8_t vector[] = {
			0x0CU, 0xC1U, 0x75U, 0xB9U, 0xC0U, 0xF1U, 0xB6U, 0xA8U,
			0x31U, 0xC3U, 0x99U, 0xE2U, 0x69U, 0x77U, 0x26U, 0x61U,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const char data[3] = "abc";

		static const uint8_t vector[] = {
			0x90U, 0x01U, 0x50U, 0x98U, 0x3CU, 0xD2U, 0x4FU, 0xB0U,
			0xD6U, 0x96U, 0x3FU, 0x7DU, 0x28U, 0xE1U, 0x7FU, 0x72U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const char data[14] = "message digest";

		static const uint8_t vector[] = {
			0xF9U, 0x6BU, 0x69U, 0x7DU, 0x7CU, 0xB7U, 0x93U, 0x8DU,
			0x52U, 0x5AU, 0x2FU, 0x31U, 0xAAU, 0xF1U, 0x61U, 0xD0U,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const char data[26] = "abcdefghijklmnopqrstuvwxyz";

		static const uint8_t vector[] = {
			0xC3U, 0xFCU, 0xD3U, 0xD7U, 0x61U, 0x92U, 0xE4U, 0x00U,
			0x7DU, 0xFBU, 0x49U, 0x6CU, 0xCAU, 0x67U, 0xE1U, 0x3BU,
		};

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 6 *
		 *****************/

		static const char data[62] = ""
		  "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmn"
		  "opqrstuvwxyz0123456789";

		static const uint8_t vector[] = {
			0xD1U, 0x74U, 0xABU, 0x98U, 0xD2U, 0x77U, 0xD9U, 0xF5U,
			0xA5U, 0x61U, 0x1CU, 0x2CU, 0x9FU, 0x41U, 0x9DU, 0x9FU,
		};

		(void) slog(LG_DEBUG, "%s: vector 6", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 7 *
		 *****************/

		static const char data[80] = ""
		  "1234567890123456789012345678901234567890"
		  "1234567890123456789012345678901234567890";

		static const uint8_t vector[] = {
			0x57U, 0xEDU, 0xF4U, 0xA2U, 0x2BU, 0xE3U, 0xC9U, 0x55U,
			0xACU, 0x49U, 0xDAU, 0x2EU, 0x21U, 0x07U, 0xB6U, 0x7AU,
		};

		(void) slog(LG_DEBUG, "%s: vector 7", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_MD5, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_hmac_md5(void)
{
	uint8_t result[DIGEST_MDLEN_MD5];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t key[] = {
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
		};

		static const char data[8] = "Hi There";

		static const uint8_t vector[] = {
			0x92U, 0x94U, 0x72U, 0x7AU, 0x36U, 0x38U, 0xBBU, 0x1CU,
			0x13U, 0xF4U, 0x8EU, 0xF8U, 0x15U, 0x8BU, 0xFCU, 0x9DU,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char key[4] = "Jefe";

		static const char data[28] = "what do ya want for nothing?";

		static const uint8_t vector[] = {
			0x75U, 0x0CU, 0x78U, 0x3EU, 0x6AU, 0xB0U, 0xB5U, 0x03U,
			0xEAU, 0xA8U, 0x6EU, 0x31U, 0x0AU, 0x5DU, 0xB7U, 0x38U,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const uint8_t data[] = {
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU,
		};

		static const uint8_t vector[] = {
			0x56U, 0xBEU, 0x34U, 0x52U, 0x1DU, 0x14U, 0x4CU, 0x88U,
			0xDBU, 0xB8U, 0xC7U, 0x33U, 0xF0U, 0xE8U, 0xB3U, 0xF6U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t key[] = {
			0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U, 0x08U,
			0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU, 0x10U,
			0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U, 0x18U,
			0x19U,
		};

		static const uint8_t data[] = {
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU,
		};

		static const uint8_t vector[] = {
			0x69U, 0x7EU, 0xAFU, 0x0AU, 0xCAU, 0x3AU, 0x3AU, 0xEAU,
			0x3AU, 0x75U, 0x16U, 0x47U, 0x46U, 0xFFU, 0xAAU, 0x79U,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const uint8_t key[] = {
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
		};

		static const char data[20] = "Test With Truncation";

		static const uint8_t vector[] = {
			0x56U, 0x46U, 0x1EU, 0xF2U, 0x34U, 0x2EU, 0xDCU, 0x00U,
			0xF9U, 0xBAU, 0xB9U, 0x95U, 0x69U, 0x0EU, 0xFDU, 0x4CU,
		};

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 6 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[54] = ""
		  "Test Using Larger Than Block-Size Key "
		  "- Hash Key First";

		static const uint8_t vector[] = {
			0x6BU, 0x1AU, 0xB7U, 0xFEU, 0x4BU, 0xD7U, 0xBFU, 0x8FU,
			0x0BU, 0x62U, 0xE6U, 0xCEU, 0x61U, 0xB9U, 0xD0U, 0xCDU,
		};

		(void) slog(LG_DEBUG, "%s: vector 6", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 7 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[73] = ""
		  "Test Using Larger Than Block-Size Key "
		  "and Larger Than One Block-Size Data";

		static const uint8_t vector[] = {
			0x6FU, 0x63U, 0x0FU, 0xADU, 0x67U, 0xCDU, 0xA0U, 0xEEU,
			0x1FU, 0xB1U, 0xF5U, 0x62U, 0xDBU, 0x3AU, 0xA5U, 0x3EU,
		};

		(void) slog(LG_DEBUG, "%s: vector 7", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_MD5, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_pbkdf2_md5(void)
{
	static const uint8_t key[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
	};

	static const uint8_t salt[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
	};

	static const uint32_t iter = 4;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0x79U, 0x41U, 0x2EU, 0xB8U, 0xE7U, 0x82U, 0x09U, 0x06U,
			0x69U, 0x8DU, 0x9FU, 0x20U, 0x4FU, 0x17U, 0x93U, 0xCBU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_MD5, NULL, 0, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const uint8_t vector[] = {
			0x6AU, 0x81U, 0xF9U, 0x40U, 0x82U, 0x96U, 0x01U, 0x19U,
			0xCCU, 0xDFU, 0x52U, 0x22U, 0x20U, 0x7CU, 0xDAU, 0xD7U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_MD5, NULL, 0, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t vector[] = {
			0xCCU, 0xCFU, 0x34U, 0x02U, 0xBDU, 0xB2U, 0x28U, 0x6DU,
			0xF1U, 0x22U, 0x6AU, 0x76U, 0xEDU, 0x80U, 0x43U, 0xF0U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_MD5, key, sizeof key, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t vector[] = {
			0x32U, 0xC9U, 0xF0U, 0xABU, 0xD3U, 0x16U, 0xBFU, 0x47U,
			0xDDU, 0x93U, 0xEAU, 0x90U, 0x6DU, 0x8DU, 0xBDU, 0xA2U,
			0x43U, 0x2CU, 0x86U, 0xDAU, 0xBBU, 0x98U, 0x11U, 0x83U,
			0x04U, 0x83U, 0x9DU, 0xABU, 0x37U, 0x88U, 0xC0U, 0x88U,
			0xB2U, 0x82U, 0xDBU, 0x8FU, 0x98U, 0xF7U, 0xF7U, 0x6DU,
			0xCFU, 0x59U, 0x61U, 0xEDU, 0xB2U, 0x19U, 0x80U, 0x0EU,
			0x6AU, 0x8EU, 0x83U, 0x43U, 0xD4U, 0x67U, 0x5AU, 0xE5U,
			0x58U, 0x44U, 0x03U, 0x66U, 0xAFU, 0x65U, 0xB2U, 0x5CU,
			0xB6U, 0x41U, 0xFBU, 0xF9U, 0xF0U, 0x8FU, 0xF7U, 0xC2U,
			0x21U, 0x90U, 0xCEU, 0x64U, 0x43U, 0x76U, 0xBEU, 0xCDU,
			0x96U, 0xAFU, 0x75U, 0xFEU, 0x5CU, 0x45U, 0xE9U, 0x92U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_MD5, key, sizeof key, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	return true;
}

static bool
digest_testsuite_run_sha1(void)
{
	uint8_t result[DIGEST_MDLEN_SHA1];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0xDAU, 0x39U, 0xA3U, 0xEEU, 0x5EU, 0x6BU, 0x4BU, 0x0DU,
			0x32U, 0x55U, 0xBFU, 0xEFU, 0x95U, 0x60U, 0x18U, 0x90U,
			0xAFU, 0xD8U, 0x07U, 0x09U,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA1, NULL, 0, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char data[3] = "abc";

		static const uint8_t vector[] = {
			0xA9U, 0x99U, 0x3EU, 0x36U, 0x47U, 0x06U, 0x81U, 0x6AU,
			0xBAU, 0x3EU, 0x25U, 0x71U, 0x78U, 0x50U, 0xC2U, 0x6CU,
			0x9CU, 0xD0U, 0xD8U, 0x9DU,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA1, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const char data[56] = ""
		  "abcdbcdecdefdefgefghfghighij"
		  "hijkijkljklmklmnlmnomnopnopq";

		static const uint8_t vector[] = {
			0x84U, 0x98U, 0x3EU, 0x44U, 0x1CU, 0x3BU, 0xD2U, 0x6EU,
			0xBAU, 0xAEU, 0x4AU, 0xA1U, 0xF9U, 0x51U, 0x29U, 0xE5U,
			0xE5U, 0x46U, 0x70U, 0xF1U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA1, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const char data[200] = ""
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";

		static const uint8_t vector[] = {
			0x34U, 0xAAU, 0x97U, 0x3CU, 0xD4U, 0xC4U, 0xDAU, 0xA4U,
			0xF6U, 0x1EU, 0xEBU, 0x2BU, 0xDBU, 0xADU, 0x27U, 0x31U,
			0x65U, 0x34U, 0x01U, 0x6FU,
		};

		const struct digest_vector data_vec[] = {
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
		};

		const size_t data_vec_len = (sizeof data_vec) / (sizeof data_vec[0]);

		struct digest_context ctx;

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_init(&ctx, DIGALG_SHA1))
			return false;

		for (size_t i = 0; i < 500; i++)
			if (! digest_update_vector(&ctx, data_vec, data_vec_len))
				return false;

		if (! digest_final(&ctx, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const char data[64] = ""
		  "01234567012345670123456701234567"
		  "01234567012345670123456701234567";

		static const uint8_t vector[] = {
			0xDEU, 0xA3U, 0x56U, 0xA2U, 0xCDU, 0xDDU, 0x90U, 0xC7U,
			0xA7U, 0xECU, 0xEDU, 0xC5U, 0xEBU, 0xB5U, 0x63U, 0x93U,
			0x4FU, 0x46U, 0x04U, 0x52U,
		};

		const struct digest_vector data_vec[] = {
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
		};

		const size_t data_vec_len = (sizeof data_vec) / (sizeof data_vec[0]);

		struct digest_context ctx;

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_init(&ctx, DIGALG_SHA1))
			return false;

		if (! digest_update_vector(&ctx, data_vec, data_vec_len))
			return false;

		if (! digest_final(&ctx, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_hmac_sha1(void)
{
	uint8_t result[DIGEST_MDLEN_SHA1];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t key[] = {
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU,
		};

		static const char data[8] = "Hi There";

		static const uint8_t vector[] = {
			0xB6U, 0x17U, 0x31U, 0x86U, 0x55U, 0x05U, 0x72U, 0x64U,
			0xE2U, 0x8BU, 0xC0U, 0xB6U, 0xFBU, 0x37U, 0x8CU, 0x8EU,
			0xF1U, 0x46U, 0xBEU, 0x00U,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char key[4] = "Jefe";

		static const char data[28] = "what do ya want for nothing?";

		static const uint8_t vector[] = {
			0xEFU, 0xFCU, 0xDFU, 0x6AU, 0xE5U, 0xEBU, 0x2FU, 0xA2U,
			0xD2U, 0x74U, 0x16U, 0xD5U, 0xF1U, 0x84U, 0xDFU, 0x9CU,
			0x25U, 0x9AU, 0x7CU, 0x79U,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const uint8_t data[] = {
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU,
		};

		static const uint8_t vector[] = {
			0x12U, 0x5DU, 0x73U, 0x42U, 0xB9U, 0xACU, 0x11U, 0xCDU,
			0x91U, 0xA3U, 0x9AU, 0xF4U, 0x8AU, 0xA1U, 0x7BU, 0x4FU,
			0x63U, 0xF1U, 0x75U, 0xD3U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t key[] = {
			0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U, 0x08U,
			0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU, 0x10U,
			0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U, 0x18U,
			0x19U,
		};

		static const uint8_t data[] = {
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU,
		};

		static const uint8_t vector[] = {
			0x4CU, 0x90U, 0x07U, 0xF4U, 0x02U, 0x62U, 0x50U, 0xC6U,
			0xBCU, 0x84U, 0x14U, 0xF9U, 0xBFU, 0x50U, 0xC8U, 0x6CU,
			0x2DU, 0x72U, 0x35U, 0xDAU,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const uint8_t key[] = {
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU,
		};

		static const char data[20] = "Test With Truncation";

		static const uint8_t vector[] = {
			0x4CU, 0x1AU, 0x03U, 0x42U, 0x4BU, 0x55U, 0xE0U, 0x7FU,
			0xE7U, 0xF2U, 0x7BU, 0xE1U, 0xD5U, 0x8BU, 0xB9U, 0x32U,
			0x4AU, 0x9AU, 0x5AU, 0x04U,
		};

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 6 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[54] = ""
		  "Test Using Larger Than Block-Size Key "
		  "- Hash Key First";

		static const uint8_t vector[] = {
			0xAAU, 0x4AU, 0xE5U, 0xE1U, 0x52U, 0x72U, 0xD0U, 0x0EU,
			0x95U, 0x70U, 0x56U, 0x37U, 0xCEU, 0x8AU, 0x3BU, 0x55U,
			0xEDU, 0x40U, 0x21U, 0x12U,
		};

		(void) slog(LG_DEBUG, "%s: vector 6", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 7 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[73] = ""
		  "Test Using Larger Than Block-Size Key "
		  "and Larger Than One Block-Size Data";

		static const uint8_t vector[] = {
			0xE8U, 0xE9U, 0x9DU, 0x0FU, 0x45U, 0x23U, 0x7DU, 0x78U,
			0x6DU, 0x6BU, 0xBAU, 0xA7U, 0x96U, 0x5CU, 0x78U, 0x08U,
			0xBBU, 0xFFU, 0x1AU, 0x91U,
		};

		(void) slog(LG_DEBUG, "%s: vector 7", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA1, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_pbkdf2_sha1(void)
{
	static const uint8_t key[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
	};

	static const uint8_t salt[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
	};

	static const uint32_t iter = 5;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0x16U, 0xA5U, 0x1FU, 0x7FU, 0x0EU, 0x43U, 0xEEU, 0xB9U,
			0xBDU, 0xE0U, 0x5DU, 0xC3U, 0x2EU, 0xDAU, 0xDAU, 0x79U,
			0x8DU, 0xA5U, 0xBAU, 0xC1U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA1, NULL, 0, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const uint8_t vector[] = {
			0x2DU, 0x95U, 0xDEU, 0xCAU, 0xFBU, 0x09U, 0x8BU, 0x49U,
			0x9CU, 0x35U, 0xCCU, 0x36U, 0x3CU, 0x28U, 0x1CU, 0xD2U,
			0x3EU, 0xE7U, 0x32U, 0x65U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA1, NULL, 0, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t vector[] = {
			0x46U, 0x72U, 0x51U, 0x24U, 0x4FU, 0x73U, 0x78U, 0x95U,
			0xFEU, 0xE9U, 0x49U, 0xF1U, 0x8EU, 0x67U, 0x3CU, 0x8AU,
			0x3EU, 0x48U, 0x88U, 0xB5U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA1, key, sizeof key, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t vector[] = {
			0x77U, 0x86U, 0xB9U, 0x70U, 0xAEU, 0x65U, 0xEEU, 0xF6U,
			0xD0U, 0x21U, 0x3CU, 0x34U, 0xF8U, 0x01U, 0x6AU, 0x8CU,
			0xBAU, 0x46U, 0xEAU, 0x6BU, 0x08U, 0x8EU, 0x93U, 0x78U,
			0xFCU, 0xCFU, 0xAFU, 0x71U, 0x7BU, 0x7DU, 0x2CU, 0x10U,
			0xBFU, 0xCEU, 0xE3U, 0x30U, 0x4BU, 0x69U, 0x64U, 0xD3U,
			0xBDU, 0x4BU, 0x11U, 0x21U, 0xD1U, 0xC0U, 0xD3U, 0xB1U,
			0x4CU, 0x93U, 0x31U, 0xD5U, 0x46U, 0x6BU, 0xD7U, 0x5DU,
			0x22U, 0x0FU, 0x0FU, 0x17U, 0x2BU, 0x16U, 0xC7U, 0xC4U,
			0x16U, 0xEEU, 0xF1U, 0x19U, 0x44U, 0x87U, 0x5EU, 0x30U,
			0x49U, 0x67U, 0xD4U, 0x51U, 0x55U, 0xCDU, 0x63U, 0xC5U,
			0xA3U, 0xCAU, 0xA4U, 0x54U, 0xD7U, 0x46U, 0x85U, 0xE6U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA1, key, sizeof key, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	return true;
}

static bool
digest_testsuite_run_sha2_256(void)
{
	uint8_t result[DIGEST_MDLEN_SHA2_256];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0xE3U, 0xB0U, 0xC4U, 0x42U, 0x98U, 0xFCU, 0x1CU, 0x14U,
			0x9AU, 0xFBU, 0xF4U, 0xC8U, 0x99U, 0x6FU, 0xB9U, 0x24U,
			0x27U, 0xAEU, 0x41U, 0xE4U, 0x64U, 0x9BU, 0x93U, 0x4CU,
			0xA4U, 0x95U, 0x99U, 0x1BU, 0x78U, 0x52U, 0xB8U, 0x55U,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_256, NULL, 0, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char data[3] = "abc";

		static const uint8_t vector[] = {
			0xBAU, 0x78U, 0x16U, 0xBFU, 0x8FU, 0x01U, 0xCFU, 0xEAU,
			0x41U, 0x41U, 0x40U, 0xDEU, 0x5DU, 0xAEU, 0x22U, 0x23U,
			0xB0U, 0x03U, 0x61U, 0xA3U, 0x96U, 0x17U, 0x7AU, 0x9CU,
			0xB4U, 0x10U, 0xFFU, 0x61U, 0xF2U, 0x00U, 0x15U, 0xADU,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_256, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const char data[56] = ""
		  "abcdbcdecdefdefgefghfghighij"
		  "hijkijkljklmklmnlmnomnopnopq";

		static const uint8_t vector[] = {
			0x24U, 0x8DU, 0x6AU, 0x61U, 0xD2U, 0x06U, 0x38U, 0xB8U,
			0xE5U, 0xC0U, 0x26U, 0x93U, 0x0CU, 0x3EU, 0x60U, 0x39U,
			0xA3U, 0x3CU, 0xE4U, 0x59U, 0x64U, 0xFFU, 0x21U, 0x67U,
			0xF6U, 0xECU, 0xEDU, 0xD4U, 0x19U, 0xDBU, 0x06U, 0xC1U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_256, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const char data[112] = ""
		  "abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn"
		  "hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu";

		static const uint8_t vector[] = {
			0xCFU, 0x5BU, 0x16U, 0xA7U, 0x78U, 0xAFU, 0x83U, 0x80U,
			0x03U, 0x6CU, 0xE5U, 0x9EU, 0x7BU, 0x04U, 0x92U, 0x37U,
			0x0BU, 0x24U, 0x9BU, 0x11U, 0xE8U, 0xF0U, 0x7AU, 0x51U,
			0xAFU, 0xACU, 0x45U, 0x03U, 0x7AU, 0xFEU, 0xE9U, 0xD1U,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_256, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const char data[200] = ""
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";

		static const uint8_t vector[] = {
			0xCDU, 0xC7U, 0x6EU, 0x5CU, 0x99U, 0x14U, 0xFBU, 0x92U,
			0x81U, 0xA1U, 0xC7U, 0xE2U, 0x84U, 0xD7U, 0x3EU, 0x67U,
			0xF1U, 0x80U, 0x9AU, 0x48U, 0xA4U, 0x97U, 0x20U, 0x0EU,
			0x04U, 0x6DU, 0x39U, 0xCCU, 0xC7U, 0x11U, 0x2CU, 0xD0U,
		};

		const struct digest_vector data_vec[] = {
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
		};

		const size_t data_vec_len = (sizeof data_vec) / (sizeof data_vec[0]);

		struct digest_context ctx;

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_init(&ctx, DIGALG_SHA2_256))
			return false;

		for (size_t i = 0; i < 500; i++)
			if (! digest_update_vector(&ctx, data_vec, data_vec_len))
				return false;

		if (! digest_final(&ctx, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_hmac_sha2_256(void)
{
	uint8_t result[DIGEST_MDLEN_SHA2_256];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t key[] = {
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU,
		};

		static const char data[8] = "Hi There";

		static const uint8_t vector[] = {
			0xB0U, 0x34U, 0x4CU, 0x61U, 0xD8U, 0xDBU, 0x38U, 0x53U,
			0x5CU, 0xA8U, 0xAFU, 0xCEU, 0xAFU, 0x0BU, 0xF1U, 0x2BU,
			0x88U, 0x1DU, 0xC2U, 0x00U, 0xC9U, 0x83U, 0x3DU, 0xA7U,
			0x26U, 0xE9U, 0x37U, 0x6CU, 0x2EU, 0x32U, 0xCFU, 0xF7U,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char key[4] = "Jefe";

		static const char data[28] = "what do ya want for nothing?";

		static const uint8_t vector[] = {
			0x5BU, 0xDCU, 0xC1U, 0x46U, 0xBFU, 0x60U, 0x75U, 0x4EU,
			0x6AU, 0x04U, 0x24U, 0x26U, 0x08U, 0x95U, 0x75U, 0xC7U,
			0x5AU, 0x00U, 0x3FU, 0x08U, 0x9DU, 0x27U, 0x39U, 0x83U,
			0x9DU, 0xECU, 0x58U, 0xB9U, 0x64U, 0xECU, 0x38U, 0x43U,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const uint8_t data[] = {
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU,
		};

		static const uint8_t vector[] = {
			0x77U, 0x3EU, 0xA9U, 0x1EU, 0x36U, 0x80U, 0x0EU, 0x46U,
			0x85U, 0x4DU, 0xB8U, 0xEBU, 0xD0U, 0x91U, 0x81U, 0xA7U,
			0x29U, 0x59U, 0x09U, 0x8BU, 0x3EU, 0xF8U, 0xC1U, 0x22U,
			0xD9U, 0x63U, 0x55U, 0x14U, 0xCEU, 0xD5U, 0x65U, 0xFEU,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t key[] = {
			0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U, 0x08U,
			0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU, 0x10U,
			0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U, 0x18U,
			0x19U,
		};

		static const uint8_t data[] = {
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU,
		};

		static const uint8_t vector[] = {
			0x82U, 0x55U, 0x8AU, 0x38U, 0x9AU, 0x44U, 0x3CU, 0x0EU,
			0xA4U, 0xCCU, 0x81U, 0x98U, 0x99U, 0xF2U, 0x08U, 0x3AU,
			0x85U, 0xF0U, 0xFAU, 0xA3U, 0xE5U, 0x78U, 0xF8U, 0x07U,
			0x7AU, 0x2EU, 0x3FU, 0xF4U, 0x67U, 0x29U, 0x66U, 0x5BU,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const uint8_t key[] = {
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU,
		};

		static const char data[20] = "Test With Truncation";

		static const uint8_t vector[] = {
			0xA3U, 0xB6U, 0x16U, 0x74U, 0x73U, 0x10U, 0x0EU, 0xE0U,
			0x6EU, 0x0CU, 0x79U, 0x6CU, 0x29U, 0x55U, 0x55U, 0x2BU,
		};

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 6 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[54] = ""
		  "Test Using Larger Than Block-Size Key "
		  "- Hash Key First";

		static const uint8_t vector[] = {
			0x60U, 0xE4U, 0x31U, 0x59U, 0x1EU, 0xE0U, 0xB6U, 0x7FU,
			0x0DU, 0x8AU, 0x26U, 0xAAU, 0xCBU, 0xF5U, 0xB7U, 0x7FU,
			0x8EU, 0x0BU, 0xC6U, 0x21U, 0x37U, 0x28U, 0xC5U, 0x14U,
			0x05U, 0x46U, 0x04U, 0x0FU, 0x0EU, 0xE3U, 0x7FU, 0x54U,
		};

		(void) slog(LG_DEBUG, "%s: vector 6", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 7 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[152] = ""
		  "This is a test using a larger than block-size key"
		  " and a larger than block-size data. The key needs"
		  " to be hashed before being used by the HMAC algor"
		  "ithm.";

		static const uint8_t vector[] = {
			0x9BU, 0x09U, 0xFFU, 0xA7U, 0x1BU, 0x94U, 0x2FU, 0xCBU,
			0x27U, 0x63U, 0x5FU, 0xBCU, 0xD5U, 0xB0U, 0xE9U, 0x44U,
			0xBFU, 0xDCU, 0x63U, 0x64U, 0x4FU, 0x07U, 0x13U, 0x93U,
			0x8AU, 0x7FU, 0x51U, 0x53U, 0x5CU, 0x3AU, 0x35U, 0xE2U,
		};

		(void) slog(LG_DEBUG, "%s: vector 7", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_256, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_pbkdf2_sha2_256(void)
{
	static const uint8_t key[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
		0x80U, 0x81U, 0x82U, 0x83U, 0x84U, 0x85U, 0x86U, 0x87U,
		0x88U, 0x89U, 0x8AU, 0x8BU, 0x8CU, 0x8DU, 0x8EU, 0x8FU,
		0x90U, 0x91U, 0x92U, 0x93U, 0x94U, 0x95U, 0x96U, 0x97U,
		0x98U, 0x99U, 0x9AU, 0x9BU, 0x9CU, 0x9DU, 0x9EU, 0x9FU,
		0xA0U, 0xA1U, 0xA2U, 0xA3U, 0xA4U, 0xA5U, 0xA6U, 0xA7U,
		0xA8U, 0xA9U, 0xAAU, 0xABU, 0xACU, 0xADU, 0xAEU, 0xAFU,
		0xB0U, 0xB1U, 0xB2U, 0xB3U, 0xB4U, 0xB5U, 0xB6U, 0xB7U,
		0xB8U, 0xB9U, 0xBAU, 0xBBU, 0xBCU, 0xBDU, 0xBEU, 0xBFU,
		0xC0U, 0xC1U, 0xC2U, 0xC3U, 0xC4U, 0xC5U, 0xC6U, 0xC7U,
		0xC8U, 0xC9U, 0xCAU, 0xCBU, 0xCCU, 0xCDU, 0xCEU, 0xCFU,
		0xD0U, 0xD1U, 0xD2U, 0xD3U, 0xD4U, 0xD5U, 0xD6U, 0xD7U,
		0xD8U, 0xD9U, 0xDAU, 0xDBU, 0xDCU, 0xDDU, 0xDEU, 0xDFU,
		0xE0U, 0xE1U, 0xE2U, 0xE3U, 0xE4U, 0xE5U, 0xE6U, 0xE7U,
		0xE8U, 0xE9U, 0xEAU, 0xEBU, 0xECU, 0xEDU, 0xEEU, 0xEFU,
		0xF0U, 0xF1U, 0xF2U, 0xF3U, 0xF4U, 0xF5U, 0xF6U, 0xF7U,
		0xF8U, 0xF9U, 0xFAU, 0xFBU, 0xFCU, 0xFDU, 0xFEU, 0xFFU,
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
		0x80U, 0x81U, 0x82U, 0x83U, 0x84U, 0x85U, 0x86U, 0x87U,
		0x88U, 0x89U, 0x8AU, 0x8BU, 0x8CU, 0x8DU, 0x8EU, 0x8FU,
		0x90U, 0x91U, 0x92U, 0x93U, 0x94U, 0x95U, 0x96U, 0x97U,
		0x98U, 0x99U, 0x9AU, 0x9BU, 0x9CU, 0x9DU, 0x9EU, 0x9FU,
		0xA0U, 0xA1U, 0xA2U, 0xA3U, 0xA4U, 0xA5U, 0xA6U, 0xA7U,
		0xA8U, 0xA9U, 0xAAU, 0xABU, 0xACU, 0xADU, 0xAEU, 0xAFU,
		0xB0U, 0xB1U, 0xB2U, 0xB3U, 0xB4U, 0xB5U, 0xB6U, 0xB7U,
		0xB8U, 0xB9U, 0xBAU, 0xBBU, 0xBCU, 0xBDU, 0xBEU, 0xBFU,
		0xC0U, 0xC1U, 0xC2U, 0xC3U, 0xC4U, 0xC5U, 0xC6U, 0xC7U,
		0xC8U, 0xC9U, 0xCAU, 0xCBU, 0xCCU, 0xCDU, 0xCEU, 0xCFU,
		0xD0U, 0xD1U, 0xD2U, 0xD3U, 0xD4U, 0xD5U, 0xD6U, 0xD7U,
		0xD8U, 0xD9U, 0xDAU, 0xDBU, 0xDCU, 0xDDU, 0xDEU, 0xDFU,
		0xE0U, 0xE1U, 0xE2U, 0xE3U, 0xE4U, 0xE5U, 0xE6U, 0xE7U,
		0xE8U, 0xE9U, 0xEAU, 0xEBU, 0xECU, 0xEDU, 0xEEU, 0xEFU,
		0xF0U, 0xF1U, 0xF2U, 0xF3U, 0xF4U, 0xF5U, 0xF6U, 0xF7U,
		0xF8U, 0xF9U, 0xFAU, 0xFBU, 0xFCU, 0xFDU, 0xFEU, 0xFFU,
	};

	static const uint8_t salt[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
	};

	static const uint32_t iter = 8;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0x21U, 0x4DU, 0xAEU, 0x20U, 0x93U, 0x91U, 0x73U, 0x4FU,
			0x31U, 0x1EU, 0x19U, 0x3DU, 0xD1U, 0x22U, 0x38U, 0xB9U,
			0xEEU, 0x13U, 0x48U, 0x97U, 0xFDU, 0x25U, 0x5FU, 0x36U,
			0xBFU, 0x07U, 0x9CU, 0xB1U, 0xAFU, 0xD4U, 0x72U, 0x2BU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_256, NULL, 0, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const uint8_t vector[] = {
			0x71U, 0xB3U, 0xA7U, 0xFAU, 0x6FU, 0xB1U, 0x54U, 0x26U,
			0xFFU, 0x98U, 0x0EU, 0x29U, 0xF3U, 0x22U, 0x7BU, 0x52U,
			0x42U, 0xB7U, 0x4BU, 0xF6U, 0x1BU, 0xD6U, 0x09U, 0x6AU,
			0xCCU, 0xDAU, 0x49U, 0xCBU, 0x1EU, 0x0FU, 0x93U, 0x0DU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_256, NULL, 0, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t vector[] = {
			0x5DU, 0xE1U, 0xBCU, 0x89U, 0x76U, 0x27U, 0xA1U, 0xC4U,
			0x69U, 0x58U, 0xD3U, 0xFBU, 0x6BU, 0x3BU, 0xF2U, 0xA3U,
			0x7FU, 0xF2U, 0xB0U, 0xD9U, 0x34U, 0x1FU, 0x1CU, 0xB8U,
			0x97U, 0x89U, 0xA4U, 0x14U, 0x4EU, 0xCDU, 0x33U, 0x98U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_256, key, sizeof key, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t vector[] = {
			0x23U, 0x70U, 0xC3U, 0x07U, 0x7BU, 0xDBU, 0x70U, 0x23U,
			0xD5U, 0x0DU, 0xC2U, 0x19U, 0xB4U, 0x4BU, 0xBCU, 0xC9U,
			0x32U, 0x16U, 0xA3U, 0x16U, 0xC0U, 0x0DU, 0x93U, 0x80U,
			0x2DU, 0xBEU, 0x6FU, 0x02U, 0xF6U, 0xC8U, 0xE3U, 0xFBU,
			0xC8U, 0x0AU, 0xECU, 0xA8U, 0xE7U, 0xCCU, 0x28U, 0x92U,
			0xBFU, 0x3DU, 0x76U, 0xB7U, 0x35U, 0xE6U, 0x07U, 0x8AU,
			0x8FU, 0x5DU, 0x82U, 0x6BU, 0x00U, 0x8DU, 0x88U, 0x46U,
			0x96U, 0xD2U, 0xE2U, 0xD9U, 0xE0U, 0x65U, 0x7FU, 0x58U,
			0xEBU, 0x90U, 0x7BU, 0xB2U, 0xB6U, 0x14U, 0x45U, 0xF7U,
			0xD6U, 0x5BU, 0xB0U, 0x24U, 0x25U, 0x32U, 0xF9U, 0xC2U,
			0x57U, 0x44U, 0x6CU, 0x52U, 0x60U, 0xD5U, 0xF3U, 0xDFU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_256, key, sizeof key, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	return true;
}

static bool
digest_testsuite_run_sha2_512(void)
{
	uint8_t result[DIGEST_MDLEN_SHA2_512];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0xCFU, 0x83U, 0xE1U, 0x35U, 0x7EU, 0xEFU, 0xB8U, 0xBDU,
			0xF1U, 0x54U, 0x28U, 0x50U, 0xD6U, 0x6DU, 0x80U, 0x07U,
			0xD6U, 0x20U, 0xE4U, 0x05U, 0x0BU, 0x57U, 0x15U, 0xDCU,
			0x83U, 0xF4U, 0xA9U, 0x21U, 0xD3U, 0x6CU, 0xE9U, 0xCEU,
			0x47U, 0xD0U, 0xD1U, 0x3CU, 0x5DU, 0x85U, 0xF2U, 0xB0U,
			0xFFU, 0x83U, 0x18U, 0xD2U, 0x87U, 0x7EU, 0xECU, 0x2FU,
			0x63U, 0xB9U, 0x31U, 0xBDU, 0x47U, 0x41U, 0x7AU, 0x81U,
			0xA5U, 0x38U, 0x32U, 0x7AU, 0xF9U, 0x27U, 0xDAU, 0x3EU,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_512, NULL, 0, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char data[3] = "abc";

		static const uint8_t vector[] = {
			0xDDU, 0xAFU, 0x35U, 0xA1U, 0x93U, 0x61U, 0x7AU, 0xBAU,
			0xCCU, 0x41U, 0x73U, 0x49U, 0xAEU, 0x20U, 0x41U, 0x31U,
			0x12U, 0xE6U, 0xFAU, 0x4EU, 0x89U, 0xA9U, 0x7EU, 0xA2U,
			0x0AU, 0x9EU, 0xEEU, 0xE6U, 0x4BU, 0x55U, 0xD3U, 0x9AU,
			0x21U, 0x92U, 0x99U, 0x2AU, 0x27U, 0x4FU, 0xC1U, 0xA8U,
			0x36U, 0xBAU, 0x3CU, 0x23U, 0xA3U, 0xFEU, 0xEBU, 0xBDU,
			0x45U, 0x4DU, 0x44U, 0x23U, 0x64U, 0x3CU, 0xE8U, 0x0EU,
			0x2AU, 0x9AU, 0xC9U, 0x4FU, 0xA5U, 0x4CU, 0xA4U, 0x9FU,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_512, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const char data[56] = ""
		  "abcdbcdecdefdefgefghfghighij"
		  "hijkijkljklmklmnlmnomnopnopq";

		static const uint8_t vector[] = {
			0x20U, 0x4AU, 0x8FU, 0xC6U, 0xDDU, 0xA8U, 0x2FU, 0x0AU,
			0x0CU, 0xEDU, 0x7BU, 0xEBU, 0x8EU, 0x08U, 0xA4U, 0x16U,
			0x57U, 0xC1U, 0x6EU, 0xF4U, 0x68U, 0xB2U, 0x28U, 0xA8U,
			0x27U, 0x9BU, 0xE3U, 0x31U, 0xA7U, 0x03U, 0xC3U, 0x35U,
			0x96U, 0xFDU, 0x15U, 0xC1U, 0x3BU, 0x1BU, 0x07U, 0xF9U,
			0xAAU, 0x1DU, 0x3BU, 0xEAU, 0x57U, 0x78U, 0x9CU, 0xA0U,
			0x31U, 0xADU, 0x85U, 0xC7U, 0xA7U, 0x1DU, 0xD7U, 0x03U,
			0x54U, 0xECU, 0x63U, 0x12U, 0x38U, 0xCAU, 0x34U, 0x45U,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_512, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const char data[112] = ""
		  "abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn"
		  "hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu";

		static const uint8_t vector[] = {
			0x8EU, 0x95U, 0x9BU, 0x75U, 0xDAU, 0xE3U, 0x13U, 0xDAU,
			0x8CU, 0xF4U, 0xF7U, 0x28U, 0x14U, 0xFCU, 0x14U, 0x3FU,
			0x8FU, 0x77U, 0x79U, 0xC6U, 0xEBU, 0x9FU, 0x7FU, 0xA1U,
			0x72U, 0x99U, 0xAEU, 0xADU, 0xB6U, 0x88U, 0x90U, 0x18U,
			0x50U, 0x1DU, 0x28U, 0x9EU, 0x49U, 0x00U, 0xF7U, 0xE4U,
			0x33U, 0x1BU, 0x99U, 0xDEU, 0xC4U, 0xB5U, 0x43U, 0x3AU,
			0xC7U, 0xD3U, 0x29U, 0xEEU, 0xB6U, 0xDDU, 0x26U, 0x54U,
			0x5EU, 0x96U, 0xE5U, 0x5BU, 0x87U, 0x4BU, 0xE9U, 0x09U,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot(DIGALG_SHA2_512, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const char data[200] = ""
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
		  "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";

		static const uint8_t vector[] = {
			0xE7U, 0x18U, 0x48U, 0x3DU, 0x0CU, 0xE7U, 0x69U, 0x64U,
			0x4EU, 0x2EU, 0x42U, 0xC7U, 0xBCU, 0x15U, 0xB4U, 0x63U,
			0x8EU, 0x1FU, 0x98U, 0xB1U, 0x3BU, 0x20U, 0x44U, 0x28U,
			0x56U, 0x32U, 0xA8U, 0x03U, 0xAFU, 0xA9U, 0x73U, 0xEBU,
			0xDEU, 0x0FU, 0xF2U, 0x44U, 0x87U, 0x7EU, 0xA6U, 0x0AU,
			0x4CU, 0xB0U, 0x43U, 0x2CU, 0xE5U, 0x77U, 0xC3U, 0x1BU,
			0xEBU, 0x00U, 0x9CU, 0x5CU, 0x2CU, 0x49U, 0xAAU, 0x2EU,
			0x4EU, 0xADU, 0xB2U, 0x17U, 0xADU, 0x8CU, 0xC0U, 0x9BU,
		};

		const struct digest_vector data_vec[] = {
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
			{ .ptr = data, .len = sizeof data },
		};

		const size_t data_vec_len = (sizeof data_vec) / (sizeof data_vec[0]);

		struct digest_context ctx;

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_init(&ctx, DIGALG_SHA2_512))
			return false;

		for (size_t i = 0; i < 500; i++)
			if (! digest_update_vector(&ctx, data_vec, data_vec_len))
				return false;

		if (! digest_final(&ctx, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_hmac_sha2_512(void)
{
	uint8_t result[DIGEST_MDLEN_SHA2_512];

	size_t mdlen = sizeof result;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t key[] = {
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU, 0x0BU,
			0x0BU, 0x0BU, 0x0BU, 0x0BU,
		};

		static const char data[8] = "Hi There";

		static const uint8_t vector[] = {
			0x87U, 0xAAU, 0x7CU, 0xDEU, 0xA5U, 0xEFU, 0x61U, 0x9DU,
			0x4FU, 0xF0U, 0xB4U, 0x24U, 0x1AU, 0x1DU, 0x6CU, 0xB0U,
			0x23U, 0x79U, 0xF4U, 0xE2U, 0xCEU, 0x4EU, 0xC2U, 0x78U,
			0x7AU, 0xD0U, 0xB3U, 0x05U, 0x45U, 0xE1U, 0x7CU, 0xDEU,
			0xDAU, 0xA8U, 0x33U, 0xB7U, 0xD6U, 0xB8U, 0xA7U, 0x02U,
			0x03U, 0x8BU, 0x27U, 0x4EU, 0xAEU, 0xA3U, 0xF4U, 0xE4U,
			0xBEU, 0x9DU, 0x91U, 0x4EU, 0xEBU, 0x61U, 0xF1U, 0x70U,
			0x2EU, 0x69U, 0x6CU, 0x20U, 0x3AU, 0x12U, 0x68U, 0x54U,
		};

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const char key[4] = "Jefe";

		static const char data[28] = "what do ya want for nothing?";

		static const uint8_t vector[] = {
			0x16U, 0x4BU, 0x7AU, 0x7BU, 0xFCU, 0xF8U, 0x19U, 0xE2U,
			0xE3U, 0x95U, 0xFBU, 0xE7U, 0x3BU, 0x56U, 0xE0U, 0xA3U,
			0x87U, 0xBDU, 0x64U, 0x22U, 0x2EU, 0x83U, 0x1FU, 0xD6U,
			0x10U, 0x27U, 0x0CU, 0xD7U, 0xEAU, 0x25U, 0x05U, 0x54U,
			0x97U, 0x58U, 0xBFU, 0x75U, 0xC0U, 0x5AU, 0x99U, 0x4AU,
			0x6DU, 0x03U, 0x4FU, 0x65U, 0xF8U, 0xF0U, 0xE6U, 0xFDU,
			0xCAU, 0xEAU, 0xB1U, 0xA3U, 0x4DU, 0x4AU, 0x6BU, 0x4BU,
			0x63U, 0x6EU, 0x07U, 0x0AU, 0x38U, 0xBCU, 0xE7U, 0x37U,
		};

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU,
		};

		static const uint8_t data[] = {
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU, 0xDDU,
			0xDDU, 0xDDU,
		};

		static const uint8_t vector[] = {
			0xFAU, 0x73U, 0xB0U, 0x08U, 0x9DU, 0x56U, 0xA2U, 0x84U,
			0xEFU, 0xB0U, 0xF0U, 0x75U, 0x6CU, 0x89U, 0x0BU, 0xE9U,
			0xB1U, 0xB5U, 0xDBU, 0xDDU, 0x8EU, 0xE8U, 0x1AU, 0x36U,
			0x55U, 0xF8U, 0x3EU, 0x33U, 0xB2U, 0x27U, 0x9DU, 0x39U,
			0xBFU, 0x3EU, 0x84U, 0x82U, 0x79U, 0xA7U, 0x22U, 0xC8U,
			0x06U, 0xB4U, 0x85U, 0xA4U, 0x7EU, 0x67U, 0xC8U, 0x07U,
			0xB9U, 0x46U, 0xA3U, 0x37U, 0xBEU, 0xE8U, 0x94U, 0x26U,
			0x74U, 0x27U, 0x88U, 0x59U, 0xE1U, 0x32U, 0x92U, 0xFBU,
		};

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t key[] = {
			0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U, 0x08U,
			0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU, 0x10U,
			0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U, 0x18U,
			0x19U,
		};

		static const uint8_t data[] = {
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU, 0xCDU,
			0xCDU, 0xCDU,
		};

		static const uint8_t vector[] = {
			0xB0U, 0xBAU, 0x46U, 0x56U, 0x37U, 0x45U, 0x8CU, 0x69U,
			0x90U, 0xE5U, 0xA8U, 0xC5U, 0xF6U, 0x1DU, 0x4AU, 0xF7U,
			0xE5U, 0x76U, 0xD9U, 0x7FU, 0xF9U, 0x4BU, 0x87U, 0x2DU,
			0xE7U, 0x6FU, 0x80U, 0x50U, 0x36U, 0x1EU, 0xE3U, 0xDBU,
			0xA9U, 0x1CU, 0xA5U, 0xC1U, 0x1AU, 0xA2U, 0x5EU, 0xB4U,
			0xD6U, 0x79U, 0x27U, 0x5CU, 0xC5U, 0x78U, 0x80U, 0x63U,
			0xA5U, 0xF1U, 0x97U, 0x41U, 0x12U, 0x0CU, 0x4FU, 0x2DU,
			0xE2U, 0xADU, 0xEBU, 0xEBU, 0x10U, 0xA2U, 0x98U, 0xDDU,
		};

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 5 *
		 *****************/

		static const uint8_t key[] = {
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU, 0x0CU,
			0x0CU, 0x0CU, 0x0CU, 0x0CU,
		};

		static const char data[20] = "Test With Truncation";

		static const uint8_t vector[] = {
			0x41U, 0x5FU, 0xADU, 0x62U, 0x71U, 0x58U, 0x0AU, 0x53U,
			0x1DU, 0x41U, 0x79U, 0xBCU, 0x89U, 0x1DU, 0x87U, 0xA6U,
		};

		(void) slog(LG_DEBUG, "%s: vector 5", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 6 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[54] = ""
		  "Test Using Larger Than Block-Size Key "
		  "- Hash Key First";

		static const uint8_t vector[] = {
			0x80U, 0xB2U, 0x42U, 0x63U, 0xC7U, 0xC1U, 0xA3U, 0xEBU,
			0xB7U, 0x14U, 0x93U, 0xC1U, 0xDDU, 0x7BU, 0xE8U, 0xB4U,
			0x9BU, 0x46U, 0xD1U, 0xF4U, 0x1BU, 0x4AU, 0xEEU, 0xC1U,
			0x12U, 0x1BU, 0x01U, 0x37U, 0x83U, 0xF8U, 0xF3U, 0x52U,
			0x6BU, 0x56U, 0xD0U, 0x37U, 0xE0U, 0x5FU, 0x25U, 0x98U,
			0xBDU, 0x0FU, 0xD2U, 0x21U, 0x5DU, 0x6AU, 0x1EU, 0x52U,
			0x95U, 0xE6U, 0x4FU, 0x73U, 0xF6U, 0x3FU, 0x0AU, 0xECU,
			0x8BU, 0x91U, 0x5AU, 0x98U, 0x5DU, 0x78U, 0x65U, 0x98U,
		};

		(void) slog(LG_DEBUG, "%s: vector 6", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 7 *
		 *****************/

		static const uint8_t key[] = {
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU, 0xAAU,
			0xAAU, 0xAAU, 0xAAU,
		};

		static const char data[152] = ""
		  "This is a test using a larger than block-size key"
		  " and a larger than block-size data. The key needs"
		  " to be hashed before being used by the HMAC algor"
		  "ithm.";

		static const uint8_t vector[] = {
			0xE3U, 0x7BU, 0x6AU, 0x77U, 0x5DU, 0xC8U, 0x7DU, 0xBAU,
			0xA4U, 0xDFU, 0xA9U, 0xF9U, 0x6EU, 0x5EU, 0x3FU, 0xFDU,
			0xDEU, 0xBDU, 0x71U, 0xF8U, 0x86U, 0x72U, 0x89U, 0x86U,
			0x5DU, 0xF5U, 0xA3U, 0x2DU, 0x20U, 0xCDU, 0xC9U, 0x44U,
			0xB6U, 0x02U, 0x2CU, 0xACU, 0x3CU, 0x49U, 0x82U, 0xB1U,
			0x0DU, 0x5EU, 0xEBU, 0x55U, 0xC3U, 0xE4U, 0xDEU, 0x15U,
			0x13U, 0x46U, 0x76U, 0xFBU, 0x6DU, 0xE0U, 0x44U, 0x60U,
			0x65U, 0xC9U, 0x74U, 0x40U, 0xFAU, 0x8CU, 0x6AU, 0x58U,
		};

		(void) slog(LG_DEBUG, "%s: vector 7", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_hmac(DIGALG_SHA2_512, key, sizeof key, data, sizeof data, result, &mdlen))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	if (mdlen != sizeof result)
		return false;

	return true;
}

static bool
digest_testsuite_run_pbkdf2_sha2_512(void)
{
	static const uint8_t key[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
		0x80U, 0x81U, 0x82U, 0x83U, 0x84U, 0x85U, 0x86U, 0x87U,
		0x88U, 0x89U, 0x8AU, 0x8BU, 0x8CU, 0x8DU, 0x8EU, 0x8FU,
		0x90U, 0x91U, 0x92U, 0x93U, 0x94U, 0x95U, 0x96U, 0x97U,
		0x98U, 0x99U, 0x9AU, 0x9BU, 0x9CU, 0x9DU, 0x9EU, 0x9FU,
		0xA0U, 0xA1U, 0xA2U, 0xA3U, 0xA4U, 0xA5U, 0xA6U, 0xA7U,
		0xA8U, 0xA9U, 0xAAU, 0xABU, 0xACU, 0xADU, 0xAEU, 0xAFU,
		0xB0U, 0xB1U, 0xB2U, 0xB3U, 0xB4U, 0xB5U, 0xB6U, 0xB7U,
		0xB8U, 0xB9U, 0xBAU, 0xBBU, 0xBCU, 0xBDU, 0xBEU, 0xBFU,
		0xC0U, 0xC1U, 0xC2U, 0xC3U, 0xC4U, 0xC5U, 0xC6U, 0xC7U,
		0xC8U, 0xC9U, 0xCAU, 0xCBU, 0xCCU, 0xCDU, 0xCEU, 0xCFU,
		0xD0U, 0xD1U, 0xD2U, 0xD3U, 0xD4U, 0xD5U, 0xD6U, 0xD7U,
		0xD8U, 0xD9U, 0xDAU, 0xDBU, 0xDCU, 0xDDU, 0xDEU, 0xDFU,
		0xE0U, 0xE1U, 0xE2U, 0xE3U, 0xE4U, 0xE5U, 0xE6U, 0xE7U,
		0xE8U, 0xE9U, 0xEAU, 0xEBU, 0xECU, 0xEDU, 0xEEU, 0xEFU,
		0xF0U, 0xF1U, 0xF2U, 0xF3U, 0xF4U, 0xF5U, 0xF6U, 0xF7U,
		0xF8U, 0xF9U, 0xFAU, 0xFBU, 0xFCU, 0xFDU, 0xFEU, 0xFFU,
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
		0x20U, 0x21U, 0x22U, 0x23U, 0x24U, 0x25U, 0x26U, 0x27U,
		0x28U, 0x29U, 0x2AU, 0x2BU, 0x2CU, 0x2DU, 0x2EU, 0x2FU,
		0x30U, 0x31U, 0x32U, 0x33U, 0x34U, 0x35U, 0x36U, 0x37U,
		0x38U, 0x39U, 0x3AU, 0x3BU, 0x3CU, 0x3DU, 0x3EU, 0x3FU,
		0x40U, 0x41U, 0x42U, 0x43U, 0x44U, 0x45U, 0x46U, 0x47U,
		0x48U, 0x49U, 0x4AU, 0x4BU, 0x4CU, 0x4DU, 0x4EU, 0x4FU,
		0x50U, 0x51U, 0x52U, 0x53U, 0x54U, 0x55U, 0x56U, 0x57U,
		0x58U, 0x59U, 0x5AU, 0x5BU, 0x5CU, 0x5DU, 0x5EU, 0x5FU,
		0x60U, 0x61U, 0x62U, 0x63U, 0x64U, 0x65U, 0x66U, 0x67U,
		0x68U, 0x69U, 0x6AU, 0x6BU, 0x6CU, 0x6DU, 0x6EU, 0x6FU,
		0x70U, 0x71U, 0x72U, 0x73U, 0x74U, 0x75U, 0x76U, 0x77U,
		0x78U, 0x79U, 0x7AU, 0x7BU, 0x7CU, 0x7DU, 0x7EU, 0x7FU,
		0x80U, 0x81U, 0x82U, 0x83U, 0x84U, 0x85U, 0x86U, 0x87U,
		0x88U, 0x89U, 0x8AU, 0x8BU, 0x8CU, 0x8DU, 0x8EU, 0x8FU,
		0x90U, 0x91U, 0x92U, 0x93U, 0x94U, 0x95U, 0x96U, 0x97U,
		0x98U, 0x99U, 0x9AU, 0x9BU, 0x9CU, 0x9DU, 0x9EU, 0x9FU,
		0xA0U, 0xA1U, 0xA2U, 0xA3U, 0xA4U, 0xA5U, 0xA6U, 0xA7U,
		0xA8U, 0xA9U, 0xAAU, 0xABU, 0xACU, 0xADU, 0xAEU, 0xAFU,
		0xB0U, 0xB1U, 0xB2U, 0xB3U, 0xB4U, 0xB5U, 0xB6U, 0xB7U,
		0xB8U, 0xB9U, 0xBAU, 0xBBU, 0xBCU, 0xBDU, 0xBEU, 0xBFU,
		0xC0U, 0xC1U, 0xC2U, 0xC3U, 0xC4U, 0xC5U, 0xC6U, 0xC7U,
		0xC8U, 0xC9U, 0xCAU, 0xCBU, 0xCCU, 0xCDU, 0xCEU, 0xCFU,
		0xD0U, 0xD1U, 0xD2U, 0xD3U, 0xD4U, 0xD5U, 0xD6U, 0xD7U,
		0xD8U, 0xD9U, 0xDAU, 0xDBU, 0xDCU, 0xDDU, 0xDEU, 0xDFU,
		0xE0U, 0xE1U, 0xE2U, 0xE3U, 0xE4U, 0xE5U, 0xE6U, 0xE7U,
		0xE8U, 0xE9U, 0xEAU, 0xEBU, 0xECU, 0xEDU, 0xEEU, 0xEFU,
		0xF0U, 0xF1U, 0xF2U, 0xF3U, 0xF4U, 0xF5U, 0xF6U, 0xF7U,
		0xF8U, 0xF9U, 0xFAU, 0xFBU, 0xFCU, 0xFDU, 0xFEU, 0xFFU,
	};

	static const uint8_t salt[] = {
		0x00U, 0x01U, 0x02U, 0x03U, 0x04U, 0x05U, 0x06U, 0x07U,
		0x08U, 0x09U, 0x0AU, 0x0BU, 0x0CU, 0x0DU, 0x0EU, 0x0FU,
		0x10U, 0x11U, 0x12U, 0x13U, 0x14U, 0x15U, 0x16U, 0x17U,
		0x18U, 0x19U, 0x1AU, 0x1BU, 0x1CU, 0x1DU, 0x1EU, 0x1FU,
	};

	static const uint32_t iter = 8;

	{
		/*****************
		 * TEST VECTOR 1 *
		 *****************/

		static const uint8_t vector[] = {
			0x26U, 0x64U, 0x22U, 0xC3U, 0x25U, 0x48U, 0x7BU, 0x65U,
			0x1BU, 0xB6U, 0xDAU, 0xB7U, 0x1EU, 0x69U, 0xC3U, 0x55U,
			0xEAU, 0x2BU, 0xF2U, 0x5EU, 0x72U, 0x73U, 0x12U, 0x79U,
			0x9DU, 0x3EU, 0x8DU, 0x5FU, 0xB1U, 0x10U, 0xEBU, 0x59U,
			0x3AU, 0xE7U, 0xD0U, 0x8AU, 0xB7U, 0x1FU, 0x4FU, 0xF8U,
			0xDEU, 0x5BU, 0x72U, 0x0CU, 0x00U, 0x19U, 0x24U, 0x96U,
			0x27U, 0x3BU, 0x77U, 0x98U, 0x2DU, 0x94U, 0xB4U, 0x57U,
			0xD7U, 0xECU, 0x94U, 0x87U, 0xA2U, 0x06U, 0x7EU, 0x89U,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 1", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_512, NULL, 0, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 2 *
		 *****************/

		static const uint8_t vector[] = {
			0x19U, 0x23U, 0x36U, 0x42U, 0xFBU, 0x45U, 0xE6U, 0xC3U,
			0x5BU, 0x73U, 0xBAU, 0xC5U, 0x67U, 0xD8U, 0x83U, 0x14U,
			0x18U, 0xBBU, 0x7EU, 0xA3U, 0xFBU, 0x7AU, 0x8EU, 0xA2U,
			0x30U, 0xE2U, 0x64U, 0xF0U, 0x70U, 0xFFU, 0xA9U, 0x78U,
			0x57U, 0x04U, 0x6EU, 0x4BU, 0x4AU, 0xA9U, 0xACU, 0x04U,
			0x02U, 0x31U, 0x80U, 0xCCU, 0x1AU, 0x7EU, 0x09U, 0xFEU,
			0xB4U, 0xCCU, 0xC1U, 0x02U, 0xB6U, 0xABU, 0x0CU, 0x73U,
			0xDDU, 0x2DU, 0x2EU, 0xBFU, 0x1FU, 0x5EU, 0x7CU, 0x9EU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 2", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_512, NULL, 0, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 3 *
		 *****************/

		static const uint8_t vector[] = {
			0xF4U, 0x7BU, 0x32U, 0xC1U, 0xB9U, 0xFAU, 0x88U, 0xE6U,
			0x81U, 0x6CU, 0xAAU, 0x46U, 0xC2U, 0x0CU, 0x61U, 0xCAU,
			0x64U, 0x69U, 0xD2U, 0xABU, 0xAFU, 0x61U, 0x7EU, 0x45U,
			0x83U, 0xE1U, 0x4FU, 0xBCU, 0x6FU, 0xE3U, 0x9AU, 0xBEU,
			0x3EU, 0xEAU, 0xE7U, 0x23U, 0x62U, 0x83U, 0xB0U, 0x44U,
			0x18U, 0x5BU, 0xF0U, 0xF3U, 0x48U, 0xBCU, 0xBDU, 0xA1U,
			0x89U, 0xBBU, 0x19U, 0x9AU, 0x98U, 0xBFU, 0xBEU, 0x34U,
			0x61U, 0x33U, 0x6DU, 0x7BU, 0xB1U, 0x62U, 0x9AU, 0xFEU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 3", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_512, key, sizeof key, NULL, 0, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	{
		/*****************
		 * TEST VECTOR 4 *
		 *****************/

		static const uint8_t vector[] = {
			0x66U, 0xBBU, 0x29U, 0x88U, 0x44U, 0xB5U, 0x05U, 0x94U,
			0xE9U, 0xAEU, 0x54U, 0x28U, 0x63U, 0xECU, 0x2FU, 0x2AU,
			0xD1U, 0xDBU, 0x39U, 0x4BU, 0x01U, 0x74U, 0x97U, 0x86U,
			0x78U, 0xF2U, 0x4DU, 0x85U, 0x92U, 0x22U, 0xCAU, 0x4DU,
			0x9EU, 0xDBU, 0x7CU, 0xBEU, 0xABU, 0x16U, 0x97U, 0x2DU,
			0xF8U, 0x15U, 0x5BU, 0xEAU, 0xE1U, 0xF8U, 0x05U, 0xFFU,
			0x14U, 0x2DU, 0x47U, 0x71U, 0x1CU, 0xA8U, 0xCFU, 0x60U,
			0xD0U, 0x8DU, 0xDFU, 0x93U, 0xD2U, 0xE0U, 0x94U, 0xBFU,
			0x7EU, 0xE8U, 0x57U, 0xB8U, 0xC0U, 0x3CU, 0xE4U, 0x63U,
			0x04U, 0x54U, 0x33U, 0xD7U, 0xAFU, 0x09U, 0xD6U, 0x1EU,
			0xE4U, 0x53U, 0x5FU, 0xB6U, 0x91U, 0xBFU, 0x7FU, 0x5AU,
		};

		uint8_t result[sizeof vector];

		(void) slog(LG_DEBUG, "%s: vector 4", MOWGLI_FUNC_NAME);

		if (! digest_oneshot_pbkdf2(DIGALG_SHA2_512, key, sizeof key, salt, sizeof salt, iter, result, sizeof vector))
			return false;

		if (memcmp(result, vector, sizeof vector) != 0)
			return false;
	}

	return true;
}

bool
digest_testsuite_run(void)
{
	if (! digest_testsuite_run_md5())
		return false;

	if (! digest_testsuite_run_hmac_md5())
		return false;

	if (! digest_testsuite_run_pbkdf2_md5())
		return false;

	if (! digest_testsuite_run_sha1())
		return false;

	if (! digest_testsuite_run_hmac_sha1())
		return false;

	if (! digest_testsuite_run_pbkdf2_sha1())
		return false;

	if (! digest_testsuite_run_sha2_256())
		return false;

	if (! digest_testsuite_run_hmac_sha2_256())
		return false;

	if (! digest_testsuite_run_pbkdf2_sha2_256())
		return false;

	if (! digest_testsuite_run_sha2_512())
		return false;

	if (! digest_testsuite_run_hmac_sha2_512())
		return false;

	if (! digest_testsuite_run_pbkdf2_sha2_512())
		return false;

	return true;
}
